#!/bin/bash
set -euxo pipefail

# Check secret exists
if ! kubectl get secret openai-secret -n agentgateway-system &>/dev/null; then
  fail-message "The 'openai-secret' secret was not found in the agentgateway-system namespace."
  exit 1
fi

# Check Gateway exists
if ! kubectl get gateway ai-gateway -n agentgateway-system &>/dev/null; then
  fail-message "The 'ai-gateway' Gateway resource was not found."
  exit 1
fi

# Check AgentgatewayBackend exists
if ! kubectl get agentgatewaybackend openai-backend -n agentgateway-system &>/dev/null; then
  fail-message "The 'openai-backend' AgentgatewayBackend resource was not found."
  exit 1
fi

# Check HTTPRoute exists
if ! kubectl get httproute openai-route -n agentgateway-system &>/dev/null; then
  fail-message "The 'openai-route' HTTPRoute was not found."
  exit 1
fi

echo "Your first AI Gateway is configured!"
