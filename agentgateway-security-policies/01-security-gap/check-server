#!/bin/bash
set -euxo pipefail
# Check that the Gateway resource exists
if ! kubectl get gateway ai-gateway -n default &>/dev/null; then
  fail-message "Gateway 'ai-gateway' not found. Please create the Gateway resource as shown in the instructions."
  exit 1
fi

# Check that the HTTPRoute exists
if ! kubectl get httproute llm-route -n default &>/dev/null; then
  fail-message "HTTPRoute 'llm-route' not found. Please create the HTTPRoute as shown in the instructions."
  exit 1
fi

# Check that the gateway IP was saved to bashrc
if ! grep -q "GATEWAY_IP" /root/.bashrc; then
  fail-message "Gateway IP not saved to ~/.bashrc. Run: echo \"export GATEWAY_IP=\$GATEWAY_IP\" >> /root/.bashrc"
  exit 1
fi

echo "Challenge 1 complete!"
