#!/bin/bash
set -euxo pipefail

if ! kubectl get deployment -n agentgateway-system enterprise-agentgateway &>/dev/null; then
  fail-message "Enterprise AgentGateway deployment not found in agentgateway-system namespace."
  exit 1
fi

if ! kubectl get deployment -n kagent kagent-controller &>/dev/null; then
  fail-message "KAgent controller not found in kagent namespace."
  exit 1
fi

# User must verify pods and export the UI URL
if ! grep -q "KAGENT_UI_URL" /root/.bashrc; then
  fail-message "KAGENT_UI_URL not saved. Run: echo \"export KAGENT_UI_URL=http://localhost:8080\" >> ~/.bashrc"
  exit 1
fi

echo "Challenge 1 complete!"
