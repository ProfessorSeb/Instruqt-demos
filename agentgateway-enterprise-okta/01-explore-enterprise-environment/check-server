#!/bin/bash
set -euxo pipefail

# Verify controller is running
if ! kubectl get pods -n enterprise-agentgateway | grep -q Running; then
  fail-message "Enterprise Agentgateway controller is not running. Check: kubectl get pods -n enterprise-agentgateway"
  exit 1
fi

# Verify GatewayClass exists
if ! kubectl get gatewayclass enterprise-agentgateway &>/dev/null; then
  fail-message "GatewayClass 'enterprise-agentgateway' not found."
  exit 1
fi

echo "Environment verified! Let's configure the gateway."
