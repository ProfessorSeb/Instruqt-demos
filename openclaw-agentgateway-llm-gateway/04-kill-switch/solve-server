#!/bin/bash
set -euo pipefail

# Kill then restore to demonstrate the full cycle
kubectl delete httproute openai -n agentgateway-system --ignore-not-found
sleep 2
kubectl apply -f /root/openai-route.yaml

# Add aliases
grep -q "llm-kill" ~/.bashrc || cat >> ~/.bashrc << 'EOF'

# AgentGateway Kill Switch
alias llm-kill="kubectl delete httproute openai -n agentgateway-system --ignore-not-found"
alias llm-restore="kubectl apply -f /root/openai-route.yaml"
alias llm-status="kubectl get httproute,gateway -n agentgateway-system"
EOF

source ~/.bashrc || true
echo "Challenge 4 solved"
